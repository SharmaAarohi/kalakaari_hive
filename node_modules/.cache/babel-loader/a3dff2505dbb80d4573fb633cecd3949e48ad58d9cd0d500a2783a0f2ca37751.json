{"ast":null,"code":"\"use strict\";\n\n/**\n * @file JSONRPC 2.0 request authentication with steem authorities.\n * @author Johan Nordberg <johan@steemit.com>\n */\nvar __extends = this && this.__extends || function () {\n  var extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : new P(function (resolve) {\n        resolve(result.value);\n      }).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function () {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [0, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar libcrypto_1 = require(\"@steemit/libcrypto\");\nvar crypto_1 = require(\"crypto\");\n/**\n * Signing constant used to reserve opcode space and prevent cross-protocol attacks.\n * Output of `sha256('steem_jsonrpc_auth')`.\n */\nexports.K = Buffer.from('3b3b081e46ea808d5a96b08c4bc5003f5e15767090f344faab531ec57565136b', 'hex');\n/**\n * Thrown when a request fails validation.\n */\nvar ValidationError = /** @class */function (_super) {\n  __extends(ValidationError, _super);\n  function ValidationError(message, cause) {\n    var _this = _super.call(this, message) || this;\n    _this.name = 'ValidationError';\n    if (cause) {\n      _this.cause = cause;\n      _this.message += \" (\" + cause.message + \")\";\n    }\n    return _this;\n  }\n  return ValidationError;\n}(Error);\n/**\n * Create request hash to be signed.\n *\n * @param timestamp  ISO8601 formatted date e.g. `2017-11-14T19:40:29.077Z`.\n * @param account    Steem account name that is the signer.\n * @param method     RPC request method.\n * @param params     Base64 encoded JSON string containing request params.\n * @param nonce      8 bytes of random data.\n *\n * @returns bytes to be signed or validated.\n */\nfunction hashMessage(timestamp, account, method, params, nonce) {\n  var first = crypto_1.createHash('sha256');\n  first.update(timestamp);\n  first.update(account);\n  first.update(method);\n  first.update(params);\n  var second = crypto_1.createHash('sha256');\n  second.update(exports.K);\n  second.update(first.digest());\n  second.update(nonce);\n  return second.digest();\n}\n/**\n * Sign a JSON RPC Request.\n */\nfunction sign(request, account, keys) {\n  if (!request.params) {\n    throw new Error('Unable to sign a request without params');\n  }\n  var params = Buffer.from(JSON.stringify(request.params), 'utf8').toString('base64');\n  var nonceBytes = crypto_1.randomBytes(8);\n  var nonce = nonceBytes.toString('hex');\n  var timestamp = new Date().toISOString();\n  var message = hashMessage(timestamp, account, request.method, params, nonceBytes);\n  var signatures = [];\n  for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n    var key = keys_1[_i];\n    if (typeof key === 'string') {\n      key = libcrypto_1.PrivateKey.from(key);\n    }\n    var signature = libcrypto_1.hexify(key.sign(message.buffer));\n    signatures.push(signature);\n  }\n  return {\n    jsonrpc: '2.0',\n    method: request.method,\n    id: request.id,\n    params: {\n      __signed: {\n        account: account,\n        nonce: nonce,\n        params: params,\n        signatures: signatures,\n        timestamp: timestamp\n      }\n    }\n  };\n}\nexports.sign = sign;\n/**\n * Validate a signed JSON RPC request.\n * Throws a {@link ValidationError} if the request fails validation.\n *\n * @returns Resolved request params.\n */\nfunction validate(request, verify) {\n  return __awaiter(this, void 0, void 0, function () {\n    var signed, params, jsonString, nonce, timestamp, message, cause_1;\n    return __generator(this, function (_a) {\n      switch (_a.label) {\n        case 0:\n          if (request.jsonrpc !== '2.0' || typeof request.method !== 'string') {\n            throw new ValidationError('Invalid JSON RPC Request');\n          }\n          if (request.params == undefined || request.params.__signed == undefined) {\n            throw new ValidationError('Signed payload missing');\n          }\n          if (Object.keys(request.params).length !== 1) {\n            throw new ValidationError('Invalid request params');\n          }\n          signed = request.params.__signed;\n          if (signed.account == undefined) {\n            throw new ValidationError('Missing account');\n          }\n          try {\n            jsonString = Buffer.from(signed.params, 'base64').toString('utf8');\n            params = JSON.parse(jsonString);\n          } catch (cause) {\n            throw new ValidationError('Invalid encoded params', cause);\n          }\n          if (signed.nonce == undefined || typeof signed.nonce !== 'string') {\n            throw new ValidationError('Invalid nonce');\n          }\n          nonce = Buffer.from(signed.nonce, 'hex');\n          if (nonce.length !== 8) {\n            throw new ValidationError('Invalid nonce');\n          }\n          timestamp = Date.parse(signed.timestamp);\n          if (Number.isNaN(timestamp)) {\n            throw new ValidationError('Invalid timestamp');\n          }\n          if (Date.now() - timestamp > 60 * 1000) {\n            throw new ValidationError('Signature expired');\n          }\n          message = hashMessage(signed.timestamp, signed.account, request.method, signed.params, nonce);\n          _a.label = 1;\n        case 1:\n          _a.trys.push([1, 3,, 4]);\n          return [4 /*yield*/, verify(message, signed.signatures, signed.account)];\n        case 2:\n          _a.sent();\n          return [3 /*break*/, 4];\n        case 3:\n          cause_1 = _a.sent();\n          throw new ValidationError('Verification failed', cause_1);\n        case 4:\n          return [2 /*return*/, params];\n      }\n    });\n  });\n}\nexports.validate = validate;","map":{"version":3,"names":["__extends","extendStatics","Object","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","prototype","create","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","defineProperty","exports","libcrypto_1","require","crypto_1","K","Buffer","from","ValidationError","_super","message","cause","_this","name","Error","hashMessage","timestamp","account","method","params","nonce","first","createHash","update","second","digest","sign","request","keys","JSON","stringify","toString","nonceBytes","randomBytes","Date","toISOString","signatures","_i","keys_1","key","PrivateKey","signature","hexify","buffer","jsonrpc","id","__signed","validate","verify","signed","jsonString","cause_1","_a","undefined","parse","Number","isNaN","now"],"sources":["C:/Users/sunil/kalakaari/node_modules/@steemit/rpc-auth/lib/index.js"],"sourcesContent":["\"use strict\";\n/**\n * @file JSONRPC 2.0 request authentication with steem authorities.\n * @author Johan Nordberg <johan@steemit.com>\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [0, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar libcrypto_1 = require(\"@steemit/libcrypto\");\nvar crypto_1 = require(\"crypto\");\n/**\n * Signing constant used to reserve opcode space and prevent cross-protocol attacks.\n * Output of `sha256('steem_jsonrpc_auth')`.\n */\nexports.K = Buffer.from('3b3b081e46ea808d5a96b08c4bc5003f5e15767090f344faab531ec57565136b', 'hex');\n/**\n * Thrown when a request fails validation.\n */\nvar ValidationError = /** @class */ (function (_super) {\n    __extends(ValidationError, _super);\n    function ValidationError(message, cause) {\n        var _this = _super.call(this, message) || this;\n        _this.name = 'ValidationError';\n        if (cause) {\n            _this.cause = cause;\n            _this.message += \" (\" + cause.message + \")\";\n        }\n        return _this;\n    }\n    return ValidationError;\n}(Error));\n/**\n * Create request hash to be signed.\n *\n * @param timestamp  ISO8601 formatted date e.g. `2017-11-14T19:40:29.077Z`.\n * @param account    Steem account name that is the signer.\n * @param method     RPC request method.\n * @param params     Base64 encoded JSON string containing request params.\n * @param nonce      8 bytes of random data.\n *\n * @returns bytes to be signed or validated.\n */\nfunction hashMessage(timestamp, account, method, params, nonce) {\n    var first = crypto_1.createHash('sha256');\n    first.update(timestamp);\n    first.update(account);\n    first.update(method);\n    first.update(params);\n    var second = crypto_1.createHash('sha256');\n    second.update(exports.K);\n    second.update(first.digest());\n    second.update(nonce);\n    return second.digest();\n}\n/**\n * Sign a JSON RPC Request.\n */\nfunction sign(request, account, keys) {\n    if (!request.params) {\n        throw new Error('Unable to sign a request without params');\n    }\n    var params = Buffer.from(JSON.stringify(request.params), 'utf8').toString('base64');\n    var nonceBytes = crypto_1.randomBytes(8);\n    var nonce = nonceBytes.toString('hex');\n    var timestamp = new Date().toISOString();\n    var message = hashMessage(timestamp, account, request.method, params, nonceBytes);\n    var signatures = [];\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n        var key = keys_1[_i];\n        if (typeof key === 'string') {\n            key = libcrypto_1.PrivateKey.from(key);\n        }\n        var signature = libcrypto_1.hexify(key.sign(message.buffer));\n        signatures.push(signature);\n    }\n    return {\n        jsonrpc: '2.0',\n        method: request.method,\n        id: request.id,\n        params: {\n            __signed: {\n                account: account,\n                nonce: nonce,\n                params: params,\n                signatures: signatures,\n                timestamp: timestamp,\n            }\n        }\n    };\n}\nexports.sign = sign;\n/**\n * Validate a signed JSON RPC request.\n * Throws a {@link ValidationError} if the request fails validation.\n *\n * @returns Resolved request params.\n */\nfunction validate(request, verify) {\n    return __awaiter(this, void 0, void 0, function () {\n        var signed, params, jsonString, nonce, timestamp, message, cause_1;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (request.jsonrpc !== '2.0' || typeof request.method !== 'string') {\n                        throw new ValidationError('Invalid JSON RPC Request');\n                    }\n                    if (request.params == undefined || request.params.__signed == undefined) {\n                        throw new ValidationError('Signed payload missing');\n                    }\n                    if (Object.keys(request.params).length !== 1) {\n                        throw new ValidationError('Invalid request params');\n                    }\n                    signed = request.params.__signed;\n                    if (signed.account == undefined) {\n                        throw new ValidationError('Missing account');\n                    }\n                    try {\n                        jsonString = Buffer.from(signed.params, 'base64').toString('utf8');\n                        params = JSON.parse(jsonString);\n                    }\n                    catch (cause) {\n                        throw new ValidationError('Invalid encoded params', cause);\n                    }\n                    if (signed.nonce == undefined || typeof signed.nonce !== 'string') {\n                        throw new ValidationError('Invalid nonce');\n                    }\n                    nonce = Buffer.from(signed.nonce, 'hex');\n                    if (nonce.length !== 8) {\n                        throw new ValidationError('Invalid nonce');\n                    }\n                    timestamp = Date.parse(signed.timestamp);\n                    if (Number.isNaN(timestamp)) {\n                        throw new ValidationError('Invalid timestamp');\n                    }\n                    if (Date.now() - timestamp > 60 * 1000) {\n                        throw new ValidationError('Signature expired');\n                    }\n                    message = hashMessage(signed.timestamp, signed.account, request.method, signed.params, nonce);\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 3, , 4]);\n                    return [4 /*yield*/, verify(message, signed.signatures, signed.account)];\n                case 2:\n                    _a.sent();\n                    return [3 /*break*/, 4];\n                case 3:\n                    cause_1 = _a.sent();\n                    throw new ValidationError('Verification failed', cause_1);\n                case 4: return [2 /*return*/, params];\n            }\n        });\n    });\n}\nexports.validate = validate;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}